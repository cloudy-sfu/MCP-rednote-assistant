<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Bootstrap -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr"
          crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
            integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
            crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.min.js"
            integrity="sha384-7qAoOXltbVP82dhxHAUje59V5r2YsVfBafyUDxEdApLPmcdhBPg1DKg1ERo0BZlK"
            crossorigin="anonymous">
    </script>
    <!-- Bootstrap icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css"
          rel="stylesheet">
    <title>AI Agent Messages</title>
</head>
<body style="height: 100vh;">
    <div class="navbar navbar-expand-md" id="header">
        <div class="container-md">
            <a href="/" class="navbar-brand">AI agent <code>rednote</code></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarCollapse" aria-controls="navbarCollapse"
                    aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarCollapse">
                <ul class="navbar-nav me-auto mb-2 mb-md-0">
                    <li class="nav-item"><a class="nav-link" href="/config">Settings</a></li>
                    <li class="nav-item"><a class="nav-link" href="/cookies">Cookies</a></li>
                    <li class="nav-item"><a class="nav-link" href="/archive">Archive</a></li>
                    <li class="nav-item"><a class="nav-link" href="/about">About</a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="container-md">
        <div class="row justify-content-center" id="main">
            <div class="col-md-12">
                <p><b>Settings</b></p>
                <hr>
                <form class="form" action="/config/update" method="post">
                    <div class="row">
                        <div class="col-sm-6">
                            <label for="max_func_call_rounds">
                                Maximum function call rounds<code>*</code>
                            </label>
                            <p class="text-muted">
                                The maximum rounds of tool calls between user's message and
                                model's final response. A large value means the model can remember
                                longer history in the conversation, but will cost more tokens.
                                This field only affect future new conversations.
                            </p>
                        </div>
                        <div class="col-sm-2">
                            <input type="number" min="1" max="100" required
                                   id="max_func_call_rounds"
                                   name="max_func_call_rounds"
                                   class="form-control"
                                   value="{{ config.max_func_call_rounds }}"
                            >
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6">
                            <label for="openai_api_key">
                                OpenAI API Key<code>*</code>
                            </label>
                            <p class="text-muted">
                                Register and apply an API key (if you don't have) at
                                <a href="https://platform.openai.com/docs/overview" target="_blank">OpenAI Platform</a>.
                                This is a paid service directly between you and OpenAI. You're charged based on
                                tokens usage linked to this API key. This program will consume tokens and cost you
                                money, but don't directly charge you anything.
                            </p>
                        </div>
                        <div class="col-sm-6">
                            <input type="password" required
                                   id="openai_api_key"
                                   name="openai_api_key"
                                   class="form-control"
                                   value="{{ config.openai_api_key }}"
                            >
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6">
                            <label for="openai_model">
                                Model type<code>*</code>
                            </label>
                            <p class="text-muted">
                                The tokens' price of different model types are variant. Refer to
                                <a href="https://platform.openai.com/docs/pricing" target="_blank">OpenAI Pricing</a>
                                to know the tokens' price.
                            </p>
                        </div>
                        <div class="col-sm-6">
                            <select class="form-select" id="openai_model"
                                    name="openai_model">
                                {% for model in openai_model_list %}
                                    <option value="{{ model.id }}"
                                            {% if model.selected %}selected{% endif %}>
                                        {{ model.id }} ({{ model.created_date }})
                                    </option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <hr>
                    <div class="text-center my-2">
                        <input type="submit" class="btn btn-primary" value="Save">
                    </div>
                </form>
            </div>
        </div>
        <div class="row mb-0" id="footer">
            <div class="col-12 my-2">
                <span>&copy; cloudy-sfu, 2025.</span>
            </div>
        </div>
    </div>
</body>

<script>
    // set #main.height = 100vh - #header.height - #footer.height
    const header_height = document.getElementById("header").offsetHeight;
    const footer_height = document.getElementById("footer").offsetHeight;
    const main_height = window.innerHeight - header_height - footer_height;
    document.getElementById("main").style.height = `${main_height}px`;
</script>

</html>